socket open OK
socket bind OK
socket listen OK
socket: 3

socket open OK
socket bind OK
socket listen OK
socket: 4

socket open OK
socket bind OK
socket listen OK
socket: 5

Listening on port: http://localhost:8081
Listening on port: http://localhost:8085
Listening on port: http://localhost:9090
0 times looping
epoll loop: 0
3
4
5
Client fd, server constructor called
1 times looping
epoll loop: 0
handle read called
client has state0
reading from client
Received 501 bytes
header not found, finding
Request complete (headers + body)
updating client
Request line: GET /pp/ HTTP/1.1
updating done
client state: 4
Setting up sockets
Proxying to 127.0.0.1:9090/files/index.html
Connected to upstream
2 times looping
epoll loop: 0
EPOLLOUT
handle write called
Client FD: 7
Resquest: 0x56ddd3a818e0
Response: 0
State: 2

raw res from upstream: 
handle write done
epoll loop: 1
3
4
5
Client fd, server constructor called
epoll loop: 2
handleUpstreamEvent
UPSTREAM EPOLLOUT
handling upstream write for fd: 8 with client fd: 7
Client FD: 7
Resquest: 0x56ddd3a818e0
Response: 0
State: 2

Sending to client with fd 8:
GET /files/index.html HTTP/1.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding: gzip, deflate, br, zstd
Accept-Language: en-US,en;q=0.5
Connection: keep-alive
Cookie: PHPSESSID=136c73378452cbe406ffaaabc466d9ff
Host: localhost:9090
Priority: u=0, i
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:146.0) Gecko/20100101 Firefox/146.0


req sent to upstream
client state and epoll event updated
3 times looping
epoll loop: 0
EPOLLOUT
handle write called
Client FD: 7
Resquest: 0x56ddd3a818e0
Response: 0
State: 2

raw res from upstream: 
handle write done
epoll loop: 1
handle read called
client has state0
reading from client
Received 514 bytes
header not found, finding
Request complete (headers + body)
updating client
Request line: GET /files/index.html HTTP/1.1
updating done
client state: 4
4 times looping
epoll loop: 0
EPOLLOUT
handle write called
Client FD: 7
Resquest: 0x56ddd3a818e0
Response: 0
State: 2

raw res from upstream: 
handle write done
epoll loop: 1
EPOLLOUT
handle write called
Client FD: 9
Resquest: 0x56ddd3a7e9a0
Response: 0
State: 4

raw res from upstream: 
RES RDY
=========== Res Start ===========
2097152
=========== is not file, not dir ===========
=========== static ===========
Requested Path: /home/thant-htet-aung/webserv/www/html/files/index.html
=========== Res END ===========
Http version: HTTP/1.1
Error Code: 200
Error Msg: OK
Headers:
  [Connection] = close
  [Content-Length] = 244
  [Content-Type] = text/html
----------------HEADER END-----------------
Body: <!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Home</title>
</head>
<body>
	<h1>Weclome From Our Home</h1>
	<h2>files is here</h2>
</body>
</html>


Client 9 closed and removed from epoll
handle write done
5 times looping
epoll loop: 0
EPOLLOUT
handle write called
Client FD: 7
Resquest: 0x56ddd3a818e0
Response: 0
State: 2

raw res from upstream: 
handle write done
epoll loop: 1
handleUpstreamEvent
UPSTREAM EPOLLIN
Reading res from upstream
buffer from upstream read: HTTP/1.1 200 OK
Connection: close
Content-Length: 244
Content-Type: text/html

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Home</title>
</head>
<body>
	<h1>Weclome From Our Home</h1>
	<h2>files is here</h2>
</body>
</html>
; Linux x86_64; rv:146.0) Gecko/20100101 Firefox/146.0


Upstream received 328 bytes
Upstream response complete
reading res from upstream done
6 times looping
epoll loop: 0
EPOLLOUT
handle write called
Client FD: 7
Resquest: 0x56ddd3a818e0
Response: 0
State: 4

raw res from upstream: HTTP/1.1 200 OK
Connection: close
Content-Length: 244
Content-Type: text/html

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Home</title>
</head>
<body>
	<h1>Weclome From Our Home</h1>
	<h2>files is here</h2>
</body>
</html>
; Linux x86_64; rv:146.0) Gecko/20100101 Firefox/146.0


WAIT_UPSTREAM
writing to client with res from upstream:HTTP/1.1 200 OK
Connection: close
Content-Length: 244
Content-Type: text/html

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Home</title>
</head>
<body>
	<h1>Weclome From Our Home</h1>
	<h2>files is here</h2>
</body>
</html>
; Linux x86_64; rv:146.0) Gecko/20100101 Firefox/146.0


Client 7 closed and removed from epoll
handle write done
7 times looping
